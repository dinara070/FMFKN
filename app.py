import streamlit as st
import sqlite3
import pandas as pd
import hashlib
from datetime import datetime
import io

# --- –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–Ø –°–¢–û–†–Ü–ù–ö–ò ---
st.set_page_config(page_title="LMS –§–ú–§–ö–ù", layout="wide", page_icon="üéì")

# --- –ö–û–ù–°–¢–ê–ù–¢–ò ---
# –ö–ª—é—á –ø—Ä–∏–±—Ä–∞–Ω–æ –∑–∞ –∑–∞–ø–∏—Ç–æ–º, –∑–∞–ª–∏—à–∞—î–º–æ –∑–º—ñ–Ω–Ω—É –ø—É—Å—Ç–æ—é –∞–±–æ —ñ–≥–Ω–æ—Ä—É—î–º–æ
ADMIN_SECRET_KEY = "" 

# --- –î–ê–ù–Ü (–°—Ç—É–¥–µ–Ω—Ç–∏ - –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –Ω–∞–ø–æ–≤–Ω–µ–Ω–Ω—è) ---
GROUPS_DATA = {
    "1–°–û–ú": ["–ê–ª–µ–∫—Å—î—î–Ω–∫–æ –ê–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ì–∞–π–¥–∞–π –ê–Ω–∞—Ç–æ–ª—ñ–π –û–ª–µ–≥–æ–≤–∏—á", "–ñ—É—Ä–±–µ–ª—é–∫ –ü–∞–≤–ª—ñ–Ω–∞ –ü–∞–≤–ª—ñ–≤–Ω–∞", "–ó–∞—Ä—É–¥–Ω—è–∫ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ö–Ω–∏—à –î–µ–Ω–∏—Å –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–ö—Ä–∞–ø–ª—è –õ—ñ–ª—ñ—è –ê–Ω–∞—Ç–æ–ª—ñ—ó–≤–Ω–∞", "–õ–æ–≥–∞—à–∫—ñ–Ω –î–µ–Ω–∏—Å –í–ª–∞–¥–∏—Å–ª–∞–≤–æ–≤–∏—á", "–ú–∞–∑—É—Ä –í–µ—Ä–æ–Ω—ñ–∫–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ú–µ–ª—å–Ω–∏–∫ –ë–æ–≥–¥–∞–Ω –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–ü–µ—Ä–≤–∏–π –ê–Ω–¥—Ä—ñ–π –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á", "–°—É–ª–∏–º–∞ –î–∞—Ä–∏–Ω–∞ –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞", "–¢–∏–º–æ—à–µ–Ω–∫–æ –ú–∞—Ä—ñ—è –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–®–∞–ø–µ–ª—å—Å—å–∫–∞ –ö–∞—Ç–µ—Ä–∏–Ω–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–®–µ–≤—á—É–∫ –ú–∞—Ä—ñ—è –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞"],
    "1–°–û–Ü": ["–õ–∏—Å–µ–Ω–∫–æ –¢–∏–º–æ—Ñ—ñ–π –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–õ—ñ–≤–∏–π –ü–∞–≤–ª–æ –í–ª–∞–¥–∏—Å–ª–∞–≤–æ–≤–∏—á", "–ú—É—Ä–µ–Ω–∫–æ –°—Ç–µ–ø–∞–Ω –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á", "–ü–æ—Å–ø–µ–ª–æ–≤ –ù–∞–∑–∞—Ä –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á", "–†–∏–±—á—É–∫ –ê–Ω–¥—Ä—ñ–π –û–ª–µ–≥–æ–≤–∏—á", "–¢–æ–º–∞—à–µ–≤—Å—å–∫–∏–π –ê—Ä—Ç–µ–º –í–∞—Å–∏–ª—å–æ–≤–∏—á"],
    "1–ú": ["–ë–∞—Å–∞—Ä–∞–±–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –Ü–≥–æ—Ä–æ–≤–∏—á", "–ë–æ–Ω–¥–∞—Ä –í–ª–∞–¥–∏—Å–ª–∞–≤ –í–∞—Å–∏–ª—å–æ–≤–∏—á", "–î–∞–Ω—å–∫–æ–≤—Å—å–∫–∏–π –ù—ñ–∫—ñ—Ç–∞ –ì–ª—ñ–±–æ–≤–∏—á", "–ö–æ–∫–∞—Ä—î–≤–∞ –í—ñ–∫—Ç–æ—Ä—ñ—è –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–°—É–ª–∏–º–∞ –ú–∞—Ä–≥–∞—Ä—ñ—Ç–∞ –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞", "–¢–∏—à–∫—ñ–Ω–∞ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –ü–∞–≤–ª—ñ–≤–Ω–∞"],
    "1–°–û–§–ê": ["–ì–µ–Ω—Å—ñ—Ü—å–∫–∞ –ê–ª—ñ–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–ö—É—Ä—ñ–ª—å—á–µ–Ω–∫–æ –ö—ñ—Ä–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–ú–µ—Ü–≥–µ—Ä –ö–∞—Ç–µ—Ä–∏–Ω–∞ –í–∞–ª–µ—Ä—ñ—ó–≤–Ω–∞", "–ß–µ—Ä–Ω–µ—Ü—å–∫–∞ –ù–∞—Ç–∞–ª—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–®–≤–µ–¥—É–Ω –í–∞–ª–µ—Ä—ñ–π –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á"],
    "2–°–û–ú": ["–ê–¥–∞–º–ª—é–∫ –í–ª–∞–¥–∏—Å–ª–∞–≤ –†–æ–º–∞–Ω–æ–≤–∏—á", "–ë–∏—á–∫–æ –î–∞—Ä'—è –Æ—Ä—ñ—ó–≤–Ω–∞", "–ë—É–≥—Ä–æ–≤–∞ –Æ–ª—ñ—è –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–ë—É—Ä–µ–π–∫–æ –í–æ–ª–æ–¥–∏–º–∏—Ä –û–º–µ–ª—è–Ω–æ–≤–∏—á", "–ì–æ–Ω—á–∞—Ä—É–∫ –ê–Ω–≥–µ–ª—ñ–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ì—Ä—ñ—â–µ–Ω–∫–æ –°–≤—ñ—Ç–ª–∞–Ω–∞ –í–∞—Å–∏–ª—ñ–≤–Ω–∞", "–ì—É–Ω—å–∫–æ –Ü–≤–∞–Ω –†–æ–º–∞–Ω–æ–≤–∏—á", "–î–æ—Ä–æ—à –†—É—Å–ª–∞–Ω –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á", "–ñ—É—Ä–∞–≤–µ–ª—å –ê–ª—å–æ–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–ó—ñ–Ω—á–µ–Ω–∫–æ –ú–∞–∫—Å–∏–º –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–ö–∞–ª—ñ–Ω—ñ–Ω –Ñ–≤–≥–µ–Ω –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–ö–∏—Å—ñ–ª—å –Ø–Ω–∞ –Æ—Ä—ñ—ó–≤–Ω–∞", "–ö–∏—Ü—è –Ø—Ä–æ—Å–ª–∞–≤ –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á", "–ö—Ä–∞–≤—á—É–∫ –Æ–ª—ñ—è –Æ—Ä—ñ—ó–≤–Ω–∞", "–ú–∞—Ä—Ç–∏–Ω—é–∫ –î—ñ–∞–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ù–∞–∑–∞—Ä—É–∫ –î—ñ–∞–Ω–∞ –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞", "–ü–∞—Å—ñ—á–Ω–∏–∫ –°–æ—Ñ—ñ—è –ù–∞–∑–∞—Ä—ñ–≤–Ω–∞", "–ü—É—Å—Ç–æ–≤—ñ—Ç –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–ü—É—á–∫–æ–≤–∞ –í–∞–ª–µ—Ä—ñ—è –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–°–∏—á—É–∫ –ê–Ω–≥–µ–ª—ñ–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–°–ª–æ–±–æ–¥—è–Ω—é–∫ –í—ñ–∫—Ç–æ—Ä—ñ—è –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–°—Ç–∞—Å—å–∫–æ–≤–∞ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –ê–Ω–∞—Ç–æ–ª—ñ—ó–≤–Ω–∞", "–•–∞—Ä–∫–µ–≤–∏—á –†—É—Å–ª–∞–Ω –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ß–µ—Ä–µ—à–Ω—è –°—Ç–∞–Ω—ñ—Å–ª–∞–≤ –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ß–æ—Ä–Ω–∞ –Ñ–ª–∏–∑–∞–≤–µ—Ç–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞"],
    "2–°–û–§–ê": ["–ú–∏–∫–æ–ª–∞–π—á—É–∫ –ú–∞–∫—Å–∏–º –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–§—É—Ä—Å—ñ–∫ –ú–∞—Ä—ñ—è –ú–∏—Ö–∞–π–ª—ñ–≤–Ω–∞"],
    "2–°–û–Ü": ["–ê–¥–∞–º–æ–≤ –í–ª–∞–¥–∏—Å–ª–∞–≤ –í—ñ—Ç–∞–ª—ñ–π–æ–≤–∏—á", "–í–µ–∫—à–∏–Ω –Ü–≥–æ—Ä –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–î—ñ–¥–µ–Ω–∫–æ –ê—Ä—Ç–µ–º –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ö–∏—Ä–∏–ª—é–∫ –Ø—Ä–æ—Å–ª–∞–≤ –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ö—É–∑–æ–≤–ª—î–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ù–æ–≤–∞–∫ –õ—ñ–ª—ñ—è –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞", "–û—Å—Ç–∞–ø–æ–≤ –ê–Ω—Ç–æ–Ω –Æ—Ä—ñ–π–æ–≤–∏—á", "–¢–∞—Ä–∞–Ω—é–∫ –°—Ç–µ–ø–∞–Ω –Ñ–≤–≥–µ–Ω—ñ–π–æ–≤–∏—á", "–®–∏–ª–æ –ì–ª—ñ–± –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–®–ø–∞–∫ –î–∞—Ä'—è –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞"],
    "2–ú": ["–ë–ª–æ–Ω—Å—å–∫–∏–π –í–ª–∞–¥–∏—Å–ª–∞–≤ –Ø—Ä–æ—Å–ª–∞–≤–æ–≤–∏—á", "–ë–æ–Ω–¥–∞—Ä –ù–∞—Ç–∞–ª—ñ—è –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–ì–æ–ª–æ–≤–∞—Ç–∞ –í–∞–ª–µ—Ä—ñ—è –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ì—Ä–∞–∂–¥–∞–Ω –¢—ñ–º—É—Ä –ö–æ—Å—Ç—è–Ω—Ç–∏–Ω–æ–≤–∏—á", "–ì—É—Ü–æ–ª –ê–ª—å–æ–Ω–∞ –í–∞—Å–∏–ª—ñ–≤–Ω–∞", "–õ–µ–≤–µ–Ω–µ—Ü—å –í–ª–∞–¥–∏—Å–ª–∞–≤–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–õ–µ–≤—á–µ–Ω–∫–æ –ê–Ω–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–ú–∏–∫–æ–ª–∞—î–Ω–∫–æ –î–º–∏—Ç—Ä–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–°–µ–º–µ–Ω—é–∫ –ê–Ω–≥–µ–ª—ñ–Ω–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–Ø—Ü—é–∫ –í—ñ–∫—Ç–æ—Ä—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞"],
    "3–°–û–ú": ["–í–∏–Ω–∞—Ä—á–∏–∫ –°–æ—Ñ—ñ—è –°—Ç–µ–ø–∞–Ω—ñ–≤–Ω–∞", "–í–æ–ª–∏–Ω—Å—å–∫–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ö–ª–∞–Ω—Ü–∞—Ç–∏–π –ö–æ—Å—Ç—è–Ω—Ç–∏–Ω –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ö—Ä–∞–º–∞—Ä –ê–Ω–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ö—É–∑—å–º–µ–Ω–∫–æ –ö–∞—Ä–∏–Ω–∞ –õ–µ–æ–Ω—ñ–¥—ñ–≤–Ω–∞", "–õ–∏—Å–∞–∫–æ–≤ –í—ñ—Ç–∞–ª—ñ–π –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á", "–õ—É—á–∫–æ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–ú–∞—Ä—Ç–∏–Ω–µ–Ω–∫–æ –í–ª–∞–¥–∏—Å–ª–∞–≤ –Ü–≥–æ—Ä–æ–≤–∏—á", "–ú–∏—Ö–∞–π–ª–µ–Ω–∫–æ –í—ñ–∫—Ç–æ—Ä—ñ—è –Ü–≤–∞–Ω—ñ–≤–Ω–∞", "–ù–µ—Ñ–µ–¥–æ–≤–∞ –ö—Å–µ–Ω—ñ—è –Ñ–≤–≥–µ–Ω—ñ—ó–Ω–∞", "–ü–∞–ø–ª—ñ–Ω—Å—å–∫–∞ –Ü—Ä–∏–Ω–∞ –ü–µ—Ç—Ä—ñ–≤–Ω–∞", "–†—É–¥–∫–µ–≤–∏—á –û–ª—å–≥–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–°–µ—Ä–≤–µ—Ç–Ω—ñ–∫ –õ—ñ–ª—ñ—è –Ø—Ä–æ—Å–ª–∞–≤—ñ–≤–Ω–∞", "–£—Å–∞—Ç—é–∫ –û–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –í–∞–¥–∏–º—ñ–≤–Ω–∞", "–•–æ–≤–∞–Ω–µ—Ü—å –ú–∞—Ä º—è–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–ß–µ—Ä–Ω—É—Ö–∞ –°–æ—Ñ—ñ—è –Æ—Ä—ñ—ó–≤–Ω–∞", "–®–ø–æ—Ä—Ç–∫–æ –í—ñ–∫—Ç–æ—Ä—ñ—è –ú–∏—Ö–∞–π–ª—ñ–≤–Ω–∞"],
    "3–°–û–Ü": ["–ë–∞–±—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞", "–î—ñ—Ö—Ç—è—Ä –í—ñ—Ç–∞–ª—ñ–π –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á", "–î–æ–≤–∂–æ–∫ –í—ñ–∫—Ç–æ—Ä –ü–µ—Ç—Ä–æ–≤–∏—á", "–ö–∞–∑–∞–Ω–æ–∫ –Ñ–≥–æ—Ä –ú–∏—Ö–∞–π–ª–æ–≤–∏—á", "–ú–∞–∫–æ–≤—ñ—Ü—å–∫–∏–π –û–ª–µ–∫—Å—ñ–π –õ–µ–æ–Ω—ñ–¥–æ–≤–∏—á", "–ü–∏—Å—å–º–µ–Ω–Ω–∏–π –°–µ—Ä–≥—ñ–π –í–∞—Å–∏–ª—å–æ–≤–∏—á", "–†–µ–ø–µ–π –ê–Ω–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–°—Ç–∞–Ω–∫–µ–≤–∏—á –û–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á", "–°—Ç—Ä–∞—Ç—ñ–π—á—É–∫ –Ü–≤–∞–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–®–∞—Ç–∫–æ–≤—Å—å–∫–∏–π –î–º–∏—Ç—Ä–æ –ü–µ—Ç—Ä–æ–≤–∏—á", "–®—É–º–∏–ª–æ –î–∞—Ä–∏–Ω–∞ –í–∞—Å–∏–ª—ñ–≤–Ω–∞"],
    "3–°–û–§–ê": ["–ö–ª–∞–ø—É—â–∞–∫ –ë–æ–≥–¥–∞–Ω –í—ñ—Ç–∞–ª—ñ–π–æ–≤–∏—á", "–ü—Ä–∏—Å—è–∂–Ω—é–∫ –Ü–≤–∞–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–°—Ç–∞—Å—é–∫ –í–∞–¥–∏–º –í–æ–ª—å–¥–µ–º–∞—Ä–æ–≤–∏—á", "–¢–µ—Ä–∞–∫—Ç –î–º–∏—Ç—Ä–æ –í–∞—Å–∏–ª—å–æ–≤–∏—á", "–•—ñ—Ö–ª–æ –Ü—Ä–∏–Ω–∞ –í–∞–ª–µ—Ä—ñ—ó–≤–Ω–∞"],
    "3–ú": ["–ë–∞—á–æ–∫ –ú–∏–∫–æ–ª–∞ –ü–µ—Ç—Ä–æ–≤–∏—á", "–ö–æ–±–µ—Ä–Ω–∏–∫ –Ü—Ä–∏–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ü–æ–ø—ñ–ª—å –Æ–ª—ñ–∞–Ω–∞ –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞", "–°–µ–º–µ–Ω–µ—Ü—å –í–µ—Ä–æ–Ω—ñ–∫–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–¶–∏—Ä—É–ª—å–Ω—ñ–∫–æ–≤–∞ –ú–∞—Ä–∏–Ω–∞ –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞"],
    "4–°–û–ú": ["–ì–æ–ª–æ–≤–∞—Ç–∞ –ú–∞—Ä–∏–Ω–∞ –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞", "–ì—Ä—ñ—â–µ–Ω–∫–æ –ê–Ω–¥—Ä—ñ–π –†—É—Å–ª–∞–Ω–æ–≤–∏—á", "–ö–ª—ñ—â –Æ–ª—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ú–∞—Ä—Ç–∏–Ω—é–∫ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–ú–∞—Ö–æ–≤—Å—å–∫–∞ –í—ñ–∫—Ç–æ—Ä—ñ—è –Æ—Ä—ñ—ó–≤–Ω–∞", "–ú–æ—Ü–Ω–∞ –ú–∞—Ä—ñ—è –ê–Ω–∞—Ç–æ–ª—ñ—ó–≤–Ω–∞", "–ú—Ä—É–≥ –î–∞—Ä—ñ—è –í–∞–ª–µ–Ω—Ç–∏–Ω—ñ–≤–Ω–∞", "–ú—É–ª—è—Ä –ö–∞—Ä–∏–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ù–µ–≤—Ä—é—î–≤–∞ –î–∞—Ä'—è –í–∞—Å–∏–ª—ñ–≤–Ω–∞", "–ù–∏–∫–∏—Ç—é–∫ –Æ–ª—ñ—è –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–ü–∞–≤–ª–æ–≤–∞ –í—ñ–∫—Ç–æ—Ä—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–°–µ–≤–∞—Å—Ç—å—è–Ω–æ–≤–∞ –ö–∞—Ä—ñ–Ω–∞ –û–ª–µ–≥—ñ–≤–Ω–∞", "–°—Ç—Ä—É–±—á–µ–≤—Å—å–∫–∞ –î–∞—Ä'—è –í—è—á–µ—Å–ª–∞–≤—ñ–≤–Ω–∞", "–¢—ñ–º–æ—â–µ–Ω–∫–æ –Ü—Ä–∏–Ω–∞ –†–æ–º–∞–Ω—ñ–≤–Ω–∞", "–§–∞—à—Ç–∏–Ω—Å—å–∫–∞ –ú–∞—Ä—ñ—è –í–∞—Å–∏–ª—ñ–≤–Ω–∞", "–§—É—Ä–º–∞–Ω –ù–∞—Ç–∞–ª—ñ—è –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–•–æ–¥–∏–∫ –ê–ª—ñ–Ω–∞ –†–∞–¥—ñ–æ–Ω—ñ–≤–Ω–∞", "–®–≤–µ—Ü—å –ù–∞—Ç–∞–ª—ñ—è –Æ—Ä—ñ—ó–≤–Ω–∞"],
    "4–°–û–Ü": ["–ë–∞—Ä–∞–Ω–æ–≤—Å—å–∫–∏–π –ù—ñ–∫—ñ—Ç–∞ –Ø—Ä–æ—Å–ª–∞–≤–æ–≤–∏—á", "–í–∏—à–∫–æ–≤—Å—å–∫–∞ –í–µ—Ä–æ–Ω—ñ–∫–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–í–æ–≥–Ω–∏–∫ –í–ª–∞–¥–∏—Å–ª–∞–≤ –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–ó–æ–∑—É–ª—è –Æ–ª—ñ—è –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–ö—Ä–∞—Å—ñ–ª–∏—á –ù–∞–∑–∞—Ä—ñ–π –Ñ–≤–≥–µ–Ω–æ–≤–∏—á", "–ú–∞–ª—å–æ–≤–∞–Ω–∏–π –í—ñ—Ç–∞–ª—ñ–π –í–∞–¥–∏–º–æ–≤–∏—á", "–ü–µ–ª–µ—à–æ–∫ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –Æ—Ä—ñ—ó–≤–Ω–∞", "–°–∞–≤—ñ–Ω–∞ –ö–∞—Ä–∏–Ω–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–°–æ—Ä–æ–∫–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á", "–¢–∞–±–∞—à–Ω—é–∫ –ö–∞—Ä—ñ–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–®–∏–∫—ñ—Ä –¢–∞—Ä–∞—Å –†–æ–º–∞–Ω–æ–≤–∏—á"],
    "4–ú": ["–ö–∞—Ä–Ω–∞—É—â—É–∫ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –û–ª–µ–≥—ñ–≤–Ω–∞", "–ö–æ—Ü—é–±–∞–Ω –î—ñ–∞–Ω–∞ –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–ö–æ—Ü—é–±–∏–Ω—Å—å–∫–∞ –ê–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–°–∞—ó–Ω—á—É–∫ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –ü–∞–≤–ª—ñ–≤–Ω–∞", "–®–µ–ª—å–º–∞–Ω –õ—ñ–ª—ñ—è –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞", "–Ø–∫–∏–º—á—É–∫ –ê–ª—ñ–Ω–∞ –Æ—Ä—ñ—ó–≤–Ω–∞"],
    "4–°–û–§–ê": ["–î–µ–ª—å–Ω–µ—Ü—å–∫–∏–π –Ü–≥–æ—Ä –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á", "–î–æ–≤–≥–∞–ª—å –ú–∞—Ä–∏–Ω–∞ –ì–µ–Ω–Ω–∞–¥—ñ—ó–≤–Ω–∞", "–ó–æ–∑—É–ª—è –°–æ—Ñ—ñ—è –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞", "–ö–æ–≤–∞–ª–µ–Ω–∫–æ –ê–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ß–∞–ª–µ–Ω–∫–æ –û–ª—å–≥–∞ –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞"],
    "2–ú–°–û–ú": ["–í–æ—Ä–æ–∂–∫–æ –í—ñ–∫—Ç–æ—Ä—ñ—è –û–ª–µ–∫—Å—ñ—ó–≤–Ω–∞", "–ì–æ–Ω—á–∞—Ä –°–µ—Ä–≥—ñ–π –í—ñ—Ç–∞–ª—ñ–π–æ–≤–∏—á", "–î–∑—é–Ω—è–∫ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–ó—ñ–Ω—è–∫ –Ü–≤–∞–Ω–Ω–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞", "–Ü–≤–∞–Ω–æ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ö–µ–±–∞ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ö–æ–∑—è—Ä—á—É–∫ –ö–∞—Ç–µ—Ä–∏–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–õ–µ—â–µ–Ω–∫–æ –¢–µ—Ç—è–Ω–∞ –¢–∏–º—É—Ä—ñ–≤–Ω–∞", "–ú–∏—Ö–∞–π–ª—é—Ç–∞ –û–ª–µ–Ω–∞ –í–∞—Å–∏–ª—ñ–≤–Ω–∞", "–†—É—Ç–∫–µ–≤–∏—á –¢–µ—Ç—è–Ω–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞", "–†—è–±—É—Ö–∞ –í–µ—Ä–æ–Ω—ñ–∫–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–°–∏–¥–æ—Ä–µ–Ω–∫–æ –ê–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–¢–∏—â–µ–Ω–∫–æ –Ø–Ω–∞ –ú–∏—Ö–∞–π–ª—ñ–≤–Ω–∞", "–®—É—Ä–∏–Ω—è–∫ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –Ü–≥–æ—Ä–æ–≤–∏—á"],
    "2–ú–°–û–§–ê": ["–ë—É—Å–µ–ª –°–æ—Ñ—ñ—è –Æ—Ä—ñ—ó–≤–Ω–∞", "–ì—É–ª–∏—á –ù–∞—Ç–∞–ª—ñ—è –†—É—Å–ª–∞–Ω—ñ–≤–Ω–∞", "–ö—É–ª—å–ø–µ–∫—ñ–Ω –Ü–≥–æ—Ä –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á", "–ú–∏—Ä–æ–Ω—é–∫ –ú–∞—Ä–∏–Ω–∞ –ê–Ω–∞—Ç–æ–ª—ñ—ó–≤–Ω–∞"],
    "2–ú–°–û–Ü": ["–ö–æ–ø—Ç—î–≤ –Ü–≤–∞–Ω –í–∞–ª–µ—Ä—ñ–π–æ–≤–∏—á", "–ö–æ—Å–µ–Ω—é–∫ –ú–∞—Ä–∫ –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á", "–¢–∞—Å–∫–∞—î–≤ –î–º–∏—Ç—Ä–æ –õ–µ–æ–Ω—ñ–¥–æ–≤–∏—á", "–®–µ–≤—á—É–∫ –ü–∞–≤–ª–æ –í—ñ–∫—Ç–æ—Ä–æ–≤–∏—á"],
    "2–ú–ú": ["–ì—Ä–∏—Ü–µ–Ω–∫–æ –í–æ–ª–æ–¥–∏–º–∏—Ä –ë–æ—Ä–∏—Å–æ–≤–∏—á", "–î—ñ–¥—É—Å–µ–Ω–∫–æ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–ö—ñ–∑—ñ–º –°—Ç–µ–ø–∞–Ω –í–∞–¥–∏–º–æ–≤–∏—á", "–ü—ñ–º–µ–Ω–æ–≤ –ê–Ω–¥—Ä—ñ–π –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ß–µ—Ä–Ω—ñ—î–Ω–∫–æ –ê—Ä—Ç–µ–º –í—ñ–∫—Ç–æ—Ä–æ–≤–∏—á"],
    "1–ú–°–û–Ü": ["–ê—Ñ–∞–Ω–∞—Å—å—î–≤ –î–º–∏—Ç—Ä–æ –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á", "–ë—Ä–∏–∂–∞–∫ –í–ª–∞–¥–∏—Å–ª–∞–≤ –ê–Ω–∞—Ç–æ–ª—ñ–π–æ–≤–∏—á", "–í–∞–≤—à–∫–æ –í—ñ—Ç–∞–ª—ñ–π –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ö—ñ–∑—ñ–º –°—Ç–µ–ø–∞–Ω –í–∞–¥–∏–º–æ–≤–∏—á", "–ö–æ–≤–∞–ª–µ–Ω–∫–æ –ú–∞—Ä—ñ—á–∫–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ö–æ—Ä–æ–ª—å–æ–≤ –ú–∞–∫—Å–∏–º –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ú—É–ª—è—Ä—á—É–∫ –°–µ—Ä–≥—ñ–π –ü–∞–≤–ª–æ–≤–∏—á", "–ù–∏–∫–∏—Ç—é–∫ –î—ñ–∞–Ω–∞ –í–∞–ª–µ–Ω—Ç–∏–Ω—ñ–≤–Ω–∞", "–†–∞–ø–ª—î–≤ –ê–Ω–¥—Ä—ñ–π –Ñ–≤–≥–µ–Ω–æ–≤–∏—á", "–®–µ–≤—á—É–∫ –Ñ–≤–≥–µ–Ω –Ü–≥–æ—Ä–æ–≤–∏—á"],
    "1–ú–ú": ["–ì–µ—Ç–º–∞–Ω—á—É–∫ –ê–Ω–Ω–∞ –í–∞–ª–µ–Ω—Ç–∏–Ω—ñ–≤–Ω–∞", "–ö—É—Ö—Ç–∞ –Ü–≤–∞–Ω–∫–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞", "–°—Ç–µ—Å—é–∫ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–í–æ—Ä–æ–±–µ—Ü—å –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞", "–ö—É–ª—ñ—à –û–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –†–æ–º–∞–Ω—ñ–≤–Ω–∞", "–õ–æ–≥–≤—ñ–Ω–µ–Ω–∫–æ –ì–∞–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–û–Ω–∏—â—É–∫ –û–ª–µ–∫—Å—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–Æ—Ä—á—É–∫ –î–∞—Ä–∏–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞"],
    "1–ú–°–û–ú": ["–ö–æ–º–∞—Ä–æ–≤–∞ –ö–∞—Ä—ñ–Ω–∞ –í–∞–¥–∏–º—ñ–≤–Ω–∞", "–ó–ª–æ—Ç–∫–æ–≤—Å—å–∫–∞ –ê–ª–ª–∞ –í—ñ–ª–µ–Ω—ñ–≤–Ω–∞", "–¢–∞—Ä–∞–Ω—é–∫ –ù–∞–¥—ñ—è –í–∞—Å–∏–ª—ñ–≤–Ω–∞", "–ö–∞–∑–º—ñ—Ä—á—É–∫ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –í—ñ–∫—Ç–æ—Ä—ñ–≤–Ω–∞", "–û—Å—Ç–∞–ø—á—É–∫ –î—ñ–∞–Ω–∞ –û–ª–µ–≥—ñ–≤–Ω–∞", "–ü–∞—à–∫—ñ–≤—Å—å–∫–∏–π –ë–æ–≥–¥–∞–Ω –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–ú–∏—Ö–∞–π–ª—å–æ –õ—ñ–¥—ñ—è –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–¢–æ—Ä–∫–æ—Ç—é–∫ –Æ—Ä—ñ–π –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ö–ª–∏–º—á—É–∫ –ê–Ω–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–î—è—á—É–∫ –Ñ–≥–æ—Ä –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–Ü—Å—å–∫–æ–≤ –Ü–≥–æ—Ä –í–∞–ª–µ—Ä—ñ–π–æ–≤–∏—á", "–ë—Ä–∏—Ü–æ–≤–∞ –Ü–ª–æ–Ω–∞ –ë–æ–≥–¥–∞–Ω—ñ–≤–Ω–∞", "–†–æ–º–∞–Ω—å–∫–æ –û–ª–µ–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ë—ñ–ª–∞ –ö–∞—Ä–∏–Ω–∞ –†—É—Å–ª–∞–Ω—ñ–≤–Ω–∞", "–ê–Ω—Ç–æ—à–∫–æ –ú–∞—Ä–∏–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ –Ñ–ª–µ–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–ì—É—Ä–º–∞–Ω –ö–∞—Ç–µ—Ä–∏–Ω–∞ –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–î–æ–Ω—Å—å–∫–∞ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–ü–æ—à—Ç–∞—Ä—É–∫ –°–Ω—ñ–∂–∞–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ë–∞–π–¥–∞ –ö–∞—Ä—ñ–Ω–∞ –Ü–≥–æ—Ä—ñ–≤–Ω–∞", "–ú–∞–º—á—É—Ä –ú–∏—Ä–æ—Å–ª–∞–≤–∞ –î–º–∏—Ç—Ä—ñ–≤–Ω–∞", "–°–∞–ª–∫–µ–≤–∏—á –î–∞—Ä–∏–Ω–∞ –†–æ–º–∞–Ω—ñ–≤–Ω–∞", "–°–µ–º—á—É–∫ –û–ª–µ–≥ –í–∞—Å–∏–ª—å–æ–≤–∏—á"],
    "1–ú–°–û–§–ê": ["–ú—ñ—â–µ–Ω–∫–æ –í–ª–∞–¥–∏—Å–ª–∞–≤ –°–µ—Ä–≥—ñ–π–æ–≤–∏—á", "–ñ—É—Ä–∂–∞ –ê—Ä—Ç–µ–º –ê—Ä—Å–µ–Ω–æ–≤–∏—á", "–ë–µ—Ä–µ–∂–Ω–∞ –†–µ–≥—ñ–Ω–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–î–º–∏—Ç—Ä–µ–Ω–∫–æ –ê–Ω–∞—Å—Ç–∞—Å—ñ—è –û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ–≤–Ω–∞", "–î—Ä—ñ–º–∞ –í—ñ—Ç–∞–ª—ñ–π", "–û–ª–µ–∫—Å—ñ–π–∫–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á"]
}

TEACHERS_DATA = {
    "–ö–∞—Ñ–µ–¥—Ä–∞ –∞–ª–≥–µ–±—Ä–∏ —ñ –º–µ—Ç–æ–¥–∏–∫–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏": [
        "–ö–æ–Ω–æ—à–µ–≤—Å—å–∫–∏–π –û–ª–µ–≥ –õ–µ–æ–Ω—ñ–¥–æ–≤–∏—á (–ó–∞–≤—ñ–¥—É–≤–∞—á –∫–∞—Ñ–µ–¥—Ä–∏)", "–ú–∞—Ç—è—à –û–ª—å–≥–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞", "–ú–∏—Ö–∞–π–ª–µ–Ω–∫–æ –õ—é–±–æ–≤ –§–µ–¥–æ—Ä—ñ–≤–Ω–∞", "–í–æ—î–≤–æ–¥–∞ –ê–ª—ñ–Ω–∞ –õ–µ–æ–Ω—ñ–¥—ñ–≤–Ω–∞ (–î–µ–∫–∞–Ω —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É)",
        "–í–æ—Ç—è–∫–æ–≤–∞ –õ–µ—Å—è –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞", "–ö–∞–ª–∞—à–Ω—ñ–∫–æ–≤ –Ü–≥–æ—Ä –í‚Äô—è—á–µ—Å–ª–∞–≤–æ–≤–∏—á", "–ù–∞–∫–æ–Ω–µ—á–Ω–∞ –õ—é–¥–º–∏–ª–∞ –ô–æ—Å–∏–ø—ñ–≤–Ω–∞", "–ü–∞–Ω–∞—Å–µ–Ω–∫–æ –û–ª–µ–∫—Å—ñ–π –ë–æ—Ä–∏—Å–æ–≤–∏—á (–ó–∞—Å—Ç—É–ø–Ω–∏–∫ –¥–µ–∫–∞–Ω–∞)",
        "–¢—é—Ç—é–Ω–Ω–∏–∫ –î—ñ–∞–Ω–∞ –û–ª–µ–≥—ñ–≤–Ω–∞", "–ö–æ–º–∞—Ä–æ–≤–∞ –ö–∞—Ä–∏–Ω–∞ –í–∞–¥–∏–º—ñ–≤–Ω–∞"
    ],
    "–ö–∞—Ñ–µ–¥—Ä–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏": [
        "–ö–æ–≤—Ç–æ–Ω—é–∫ –ú–∞—Ä'—è–Ω–∞ –ú–∏—Ö–∞–π–ª—ñ–≤–Ω–∞ (–ó–∞–≤—ñ–¥—É–≤–∞—á –∫–∞—Ñ–µ–¥—Ä–∏)", "–ë–∞–∫ –°–µ—Ä–≥—ñ–π –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á (–ó–∞—Å—Ç—É–ø–Ω–∏–∫ –¥–µ–∫–∞–Ω–∞)", "–ö–ª–æ—á–∫–æ –û–∫—Å–∞–Ω–∞ –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞",
        "–ì—Ä–∞–Ω—è–∫ –í–∞–ª–µ—Ä—ñ–π –§–µ–¥–æ—Ä–æ–≤–∏—á", "–ö–æ–≤—Ç–æ–Ω—é–∫ –ì–∞–ª–∏–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–ö–æ—Å–æ–≤–µ—Ü—å –û–ª–µ–Ω–∞ –ü–∞–≤–ª—ñ–≤–Ω–∞", "–ö—Ä—É–ø—Å—å–∫–∏–π –Ø—Ä–æ—Å–ª–∞–≤ –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á",
        "–°–æ—è –û–ª–µ–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–¢—é—Ç—é–Ω –õ—é–±–æ–≤ –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞", "–õ–µ–æ–Ω–æ–≤–∞ –Ü–≤–∞–Ω–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞", "–ü–æ–ª—ñ—â—É–∫ –í—ñ—Ç–∞–ª—ñ–π –û–ª–µ–≥–æ–≤–∏—á", "–Ø—Ä–æ—à –û–∫—Å–∞–Ω–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞"
    ],
    "–ö–∞—Ñ–µ–¥—Ä–∞ —Ñ—ñ–∑–∏–∫–∏ —ñ –º–µ—Ç–æ–¥–∏–∫–∏ –Ω–∞–≤—á–∞–Ω–Ω—è —Ñ—ñ–∑–∏–∫–∏, –∞—Å—Ç—Ä–æ–Ω–æ–º—ñ—ó": [
        "–°—ñ–ª—å–≤–µ–π—Å—Ç—Ä –ê–Ω–∞—Ç–æ–ª—ñ–π –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á (–ó–∞–≤—ñ–¥—É–≤–∞—á –∫–∞—Ñ–µ–¥—Ä–∏)", "–ó–∞–±–æ–ª–æ—Ç–Ω–∏–π –í–æ–ª–æ–¥–∏–º–∏—Ä –§–µ–¥–æ—Ä–æ–≤–∏—á", "–ë—ñ–ª—é–∫ –ê–Ω–∞—Ç–æ–ª—ñ–π –Ü–≤–∞–Ω–æ–≤–∏—á",
        "–î—É–º–µ–Ω–∫–æ –í—ñ–∫—Ç–æ—Ä—ñ—è –ü–µ—Ç—Ä—ñ–≤–Ω–∞", "–ú–æ–∫–ª—é–∫ –ú–∏–∫–æ–ª–∞ –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–ö—Å–µ–Ω–¥–∑–æ–≤–∞ –û–∫—Å–∞–Ω–∞ –°–µ—Ä–≥—ñ—ó–≤–Ω–∞", "–ú–∞–º—ñ—á–µ–≤–∞ –Ü–Ω–Ω–∞ –û–ª–µ–∫—Å—ñ—ó–≤–Ω–∞",
        "–ú–æ—Ä–æ–∑ –Ø—Ä–æ—Å–ª–∞–≤ –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á", "–°—ñ–≤–∞—î–≤–∞ –ù–∞—Ç–∞–ª—ñ—è –í—ñ—Ç–∞–ª—ñ—ó–≤–Ω–∞", "–ñ—É—Ä–∂–∞ –ê—Ä—Ç–µ–º –ê—Ä—Å–µ–Ω–æ–≤–∏—á"
    ]
}

# --- BACKEND (–ë–∞–∑–∞ –î–∞–Ω–∏—Ö) ---

def make_hashes(password):
    return hashlib.sha256(str.encode(password)).hexdigest()

def check_hashes(password, hashed_text):
    if make_hashes(password) == hashed_text:
        return True
    return False

def create_connection():
    # check_same_thread=False –≤–∞–∂–ª–∏–≤–æ –¥–ª—è Streamlit
    conn = sqlite3.connect('university_v5.db', check_same_thread=False)
    return conn

def init_db():
    conn = create_connection()
    c = conn.cursor()
    
    # –¢–∞–±–ª–∏—Ü—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    c.execute('''CREATE TABLE IF NOT EXISTS users(
                username TEXT PRIMARY KEY, 
                password TEXT, 
                role TEXT, 
                full_name TEXT, 
                group_link TEXT)''')
    
    # –¢–∞–±–ª–∏—Ü—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
    c.execute('''CREATE TABLE IF NOT EXISTS students(
                id INTEGER PRIMARY KEY AUTOINCREMENT, 
                full_name TEXT, 
                group_name TEXT)''')
    
    # –¢–∞–±–ª–∏—Ü—è —Ä–æ–∑–∫–ª–∞–¥—É
    c.execute('''CREATE TABLE IF NOT EXISTS schedule(
                id INTEGER PRIMARY KEY AUTOINCREMENT, 
                group_name TEXT, 
                day TEXT, 
                time TEXT, 
                subject TEXT, 
                teacher TEXT)''')
    
    # –¢–∞–±–ª–∏—Ü—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ (–∑–∞—è–≤–∏)
    c.execute('''CREATE TABLE IF NOT EXISTS documents(
                id INTEGER PRIMARY KEY AUTOINCREMENT, 
                title TEXT, 
                student_name TEXT, 
                status TEXT, 
                date TEXT)''')
    
    # –¢–∞–±–ª–∏—Ü—è —Ñ–∞–π–ª—ñ–≤
    c.execute('''CREATE TABLE IF NOT EXISTS file_storage(
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                filename TEXT,
                file_content BLOB,
                upload_date TEXT,
                uploader TEXT)''')

    # --- –ù–û–í–ê –¢–ê–ë–õ–ò–¶–Ø: –ñ–£–†–ù–ê–õ –û–¶–Ü–ù–û–ö ---
    c.execute('''CREATE TABLE IF NOT EXISTS grades(
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                student_name TEXT,
                group_name TEXT,
                subject TEXT,
                type_of_work TEXT, 
                grade INTEGER,
                date TEXT)''')

    conn.commit()

    # –ü–µ—Ä–≤–∏–Ω–Ω–µ –Ω–∞–ø–æ–≤–Ω–µ–Ω–Ω—è
    c.execute('SELECT count(*) FROM students')
    if c.fetchone()[0] == 0:
        # –°—Ç–≤–æ—Ä—é—î–º–æ –∞–¥–º—ñ–Ω–∞
        c.execute('INSERT OR IGNORE INTO users VALUES (?,?,?,?,?)', ('admin', make_hashes('admin'), 'admin', '–ì–æ–ª–æ–≤–Ω–∏–π –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä', ''))
        
        # –ù–∞–ø–æ–≤–Ω—é—î–º–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏
        for group, names in GROUPS_DATA.items():
            for name in names:
                clean_name = name.lstrip("0123456789. ")
                c.execute('INSERT INTO students (full_name, group_name) VALUES (?,?)', (clean_name, group))
        conn.commit()
    
    return conn

# --- –î–û–ü–û–ú–Ü–ñ–ù–Ü –§–£–ù–ö–¶–Ü–á ---

def convert_df_to_csv(df):
    return df.to_csv(index=False).encode('utf-8-sig')

# --- –°–¢–û–†–Ü–ù–ö–ò ---

def login_register_page():
    st.header("üîê –í—Ö—ñ–¥ / –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è")
    
    action = st.radio("–û–±–µ—Ä—ñ—Ç—å –¥—ñ—é:", ["–í—Ö—ñ–¥", "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è"], horizontal=True)
    conn = create_connection()
    c = conn.cursor()

    if action == "–í—Ö—ñ–¥":
        username = st.text_input("–õ–æ–≥—ñ–Ω")
        password = st.text_input("–ü–∞—Ä–æ–ª—å", type='password')
        
        if st.button("–£–≤—ñ–π—Ç–∏"):
            c.execute('SELECT * FROM users WHERE username=? AND password=?', (username, make_hashes(password)))
            user = c.fetchone()
            if user:
                st.session_state['logged_in'] = True
                st.session_state['username'] = user[0]
                st.session_state['role'] = user[2]
                st.session_state['full_name'] = user[3]
                st.session_state['group'] = user[4]
                st.success(f"–í—ñ—Ç–∞—î–º–æ, {user[3]}!")
                st.rerun()
            else:
                st.error("–ù–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω –∞–±–æ –ø–∞—Ä–æ–ª—å")

    elif action == "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è":
        st.info("–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É")
        new_user = st.text_input("–í–∏–≥–∞–¥–∞–π—Ç–µ –ª–æ–≥—ñ–Ω")
        new_pass = st.text_input("–í–∏–≥–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å", type='password')
        
        role = st.selectbox("–•—Ç–æ –≤–∏?", ["student", "teacher", "admin"])
        
        full_name = ""
        group_link = ""

        if role == "admin":
            full_name = st.text_input("–ü–Ü–ë –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞", value="–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä")
            group_link = "Administration"

        elif role == "student":
            all_groups = list(GROUPS_DATA.keys())
            selected_group = st.selectbox("–í–∞—à–∞ –≥—Ä—É–ø–∞", all_groups)
            students_in_group = pd.read_sql_query(f"SELECT full_name FROM students WHERE group_name='{selected_group}'", conn)['full_name'].tolist()
            if not students_in_group:
                 st.warning("–£ —Ü—ñ–π –≥—Ä—É–ø—ñ —â–µ –Ω–µ–º–∞—î —Å–ø–∏—Å–∫—ñ–≤.")
                 return
            selected_name = st.selectbox("–û–±–µ—Ä—ñ—Ç—å —Å–≤–æ—î —ñ–º'—è", students_in_group)
            full_name = selected_name
            group_link = selected_group
        else:
            full_name = st.text_input("–í–∞—à–µ –ü–Ü–ë (–ø–æ–≤–Ω—ñ—Å—Ç—é)")
            group_link = "Staff"

        if st.button("–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è"):
            if new_user and new_pass and full_name:
                try:
                    c.execute('INSERT INTO users VALUES (?,?,?,?,?)', 
                             (new_user, make_hashes(new_pass), role, full_name, group_link))
                    conn.commit()
                    st.success("–£—Å–ø—ñ—à–Ω–æ! –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É '–í—Ö—ñ–¥'.")
                except sqlite3.IntegrityError:
                    st.error("–¶–µ–π –ª–æ–≥—ñ–Ω –≤–∂–µ –∑–∞–π–Ω—è—Ç–∏–π.")
            else:
                st.warning("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è.")

def main_panel():
    st.title("üè† –ì–æ–ª–æ–≤–Ω–∞ –ø–∞–Ω–µ–ª—å LMS")
    st.markdown(f"### –í—ñ—Ç–∞—î–º–æ, {st.session_state['full_name']}!")
    
    col1, col2, col3 = st.columns(3)
    conn = create_connection()
    
    with col1:
        st.info("**–ù–æ–≤–∏–Ω–∏ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É**")
        st.markdown("* üì¢ –†–æ–∑–ø–æ—á–∞—Ç–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É –¥–æ —Å–µ—Å—ñ—ó\n* üèÜ –í—ñ—Ç–∞—î–º–æ –ø–µ—Ä–µ–º–æ–∂—Ü—ñ–≤ –æ–ª—ñ–º–ø—ñ–∞–¥–∏\n* üìÖ –î–µ–Ω—å –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –¥–≤–µ—Ä–µ–π 20.12")
    
    with col2:
        if st.session_state['role'] == 'student':
            my_group = st.session_state['group']
            st.metric("–ú–æ—è –≥—Ä—É–ø–∞", my_group)
            count = pd.read_sql_query(f"SELECT count(*) FROM students WHERE group_name='{my_group}'", conn).iloc[0,0]
            st.metric("–û–¥–Ω–æ–≥—Ä—É–ø–Ω–∏–∫—ñ–≤", count)
        else:
            total = pd.read_sql_query("SELECT count(*) FROM students", conn).iloc[0,0]
            st.metric("–í—Å—å–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤", total)

    with col3:
        st.warning("**–î–µ–¥–ª–∞–π–Ω–∏**")
        st.markdown("* –ö—É—Ä—Å–æ–≤–∞ —Ä–æ–±–æ—Ç–∞: **15.12**\n* –ó–≤—ñ—Ç –ø–æ –ø—Ä–∞–∫—Ç–∏—Ü—ñ: **20.12**")

def students_groups_view():
    st.title("üë• –°—Ç—É–¥–µ–Ω—Ç–∏ —Ç–∞ –ì—Ä—É–ø–∏")
    conn = create_connection()
    
    # –§—ñ–ª—å—Ç—Ä–∏
    col_filter, col_act = st.columns([3, 1])
    with col_filter:
        all_groups = ["–í—Å—ñ"] + list(GROUPS_DATA.keys())
        selected_group = st.selectbox("–§—ñ–ª—å—Ç—Ä –ø–æ –≥—Ä—É–ø—ñ:", all_groups)
    
    query = "SELECT id, full_name as '–ü–Ü–ë', group_name as '–ì—Ä—É–ø–∞' FROM students"
    if selected_group != "–í—Å—ñ":
        query += f" WHERE group_name='{selected_group}'"
    
    df = pd.read_sql_query(query, conn)
    
    # –ï–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö (CSV)
    csv = convert_df_to_csv(df)
    st.download_button("‚¨áÔ∏è –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ (CSV)", csv, "students_list.csv", "text/csv")
    
    st.dataframe(df, use_container_width=True, height=500)
    
    # --- –°–ï–ö–¶–Ü–Ø –ê–î–ú–Ü–ù–Ü–°–¢–†–ê–¢–û–†–ê (CRUD) ---
    if st.session_state['role'] in ['admin', 'teacher']:
        st.divider()
        st.subheader("üõ†Ô∏è –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è (–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å)")
        
        tab1, tab2, tab3 = st.tabs(["‚ûï –î–æ–¥–∞—Ç–∏ –≤—Ä—É—á–Ω—É", "üì• –Ü–º–ø–æ—Ä—Ç (CSV)", "üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞"])
        
        # 1. –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Ä—É—á–Ω—É
        with tab1:
            with st.form("add_student"):
                new_name = st.text_input("–ü–Ü–ë")
                new_group = st.selectbox("–ì—Ä—É–ø–∞", list(GROUPS_DATA.keys()))
                if st.form_submit_button("–î–æ–¥–∞—Ç–∏"):
                    if new_name:
                        c = conn.cursor()
                        c.execute('INSERT INTO students (full_name, group_name) VALUES (?,?)', (new_name, new_group))
                        conn.commit()
                        st.success(f"–°—Ç—É–¥–µ–Ω—Ç–∞ {new_name} –¥–æ–¥–∞–Ω–æ!")
                        st.rerun()
                    else:
                        st.warning("–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è.")
        
        # 2. –Ü–º–ø–æ—Ä—Ç –∑ —Ñ–∞–π–ª—É
        with tab2:
            if st.session_state['role'] == 'admin':
                st.write("–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ CSV —Ñ–∞–π–ª. –û–±–æ–≤'—è–∑–∫–æ–≤—ñ —Å—Ç–æ–≤–ø—Ü—ñ: `full_name`, `group_name`.")
                uploaded_file = st.file_uploader("–û–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª CSV", type="csv")
                
                if uploaded_file is not None:
                    try:
                        df_uploaded = pd.read_csv(uploaded_file)
                        if 'full_name' in df_uploaded.columns and 'group_name' in df_uploaded.columns:
                            c = conn.cursor()
                            for index, row in df_uploaded.iterrows():
                                c.execute('INSERT INTO students (full_name, group_name) VALUES (?,?)', (row['full_name'], row['group_name']))
                            conn.commit()
                            st.success(f"–£—Å–ø—ñ—à–Ω–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ {len(df_uploaded)} –∑–∞–ø–∏—Å—ñ–≤!")
                            st.rerun()
                        else:
                            st.error("–§–∞–π–ª –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –∫–æ–ª–æ–Ω–∫–∏ 'full_name' —Ç–∞ 'group_name'.")
                    except Exception as e:
                        st.error(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑—á–∏—Ç—É–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—É: {e}")
            else:
                st.info("–Ü–º–ø–æ—Ä—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –¥–ª—è –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.")

        # 3. –í–∏–¥–∞–ª–µ–Ω–Ω—è (–¢—ñ–ª—å–∫–∏ –ê–¥–º—ñ–Ω)
        with tab3:
            if st.session_state['role'] == 'admin':
                st.warning("–£–≤–∞–≥–∞! –¶—è –¥—ñ—è –Ω–µ–∑–≤–æ—Ä–æ—Ç–Ω–∞.")
                all_students = pd.read_sql_query("SELECT id, full_name, group_name FROM students", conn)
                if not all_students.empty:
                    student_options = all_students.apply(lambda x: f"ID:{x['id']} | {x['full_name']} ({x['group_name']})", axis=1)
                    selected_to_delete = st.selectbox("–û–±–µ—Ä—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è", student_options)
                    
                    if st.button("‚ùå –í–∏–¥–∞–ª–∏—Ç–∏ –æ–±—Ä–∞–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞"):
                        student_id = int(selected_to_delete.split("|")[0].replace("ID:", "").strip())
                        c = conn.cursor()
                        c.execute("DELETE FROM students WHERE id=?", (student_id,))
                        conn.commit()
                        st.success("–°—Ç—É–¥–µ–Ω—Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–æ!")
                        st.rerun()
                else:
                    st.info("–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π.")
            else:
                st.error("–î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.")

def teachers_view():
    st.title("üë®‚Äçüè´ –í–∏–∫–ª–∞–¥–∞—á—ñ —Ç–∞ –ö–∞—Ñ–µ–¥—Ä–∏")
    st.markdown("–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø—Ä–æ—Ñ–µ—Å–æ—Ä—Å—å–∫–æ-–≤–∏–∫–ª–∞–¥–∞—Ü—å–∫–∏–π —Å–∫–ª–∞–¥ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É.")
    
    for department, teachers in TEACHERS_DATA.items():
        with st.expander(f"üìö {department}", expanded=True):
            for index, teacher in enumerate(teachers, 1):
                if "(" in teacher and ")" in teacher:
                    parts = teacher.split("(")
                    name = parts[0].strip()
                    role = parts[1].replace(")", "").strip()
                    st.markdown(f"**{index}. {name}** ‚Äî *{role}*")
                else:
                    st.markdown(f"{index}. {teacher}")
            st.divider()

    st.info("–ö–æ–Ω—Ç–∞–∫—Ç–∏ –∫–∞—Ñ–µ–¥—Ä —Ç–∞ —Ä–æ–∑–∫–ª–∞–¥ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π –¥–æ—Å—Ç—É–ø–Ω—ñ —É –º–µ—Ç–æ–¥–∏—Å—Ç–∞.")

def schedule_view():
    st.title("üìÖ –†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å")
    conn = create_connection()
    days = ["–ü–æ–Ω–µ–¥—ñ–ª–æ–∫", "–í—ñ–≤—Ç–æ—Ä–æ–∫", "–°–µ—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä", "–ü'—è—Ç–Ω–∏—Ü—è"]
    
    tab1, tab2 = st.tabs(["–ü–µ—Ä–µ–≥–ª—è–¥", "–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (–í–∏–∫–ª–∞–¥–∞—á—ñ)"])
    
    with tab1:
        group_filter = st.selectbox("–û–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É:", list(GROUPS_DATA.keys()), index=0)
        df_schedule = pd.read_sql_query(f"SELECT day as '–î–µ–Ω—å', time as '–ß–∞—Å', subject as '–ü—Ä–µ–¥–º–µ—Ç', teacher as '–í–∏–∫–ª–∞–¥–∞—á' FROM schedule WHERE group_name='{group_filter}'", conn)
        
        if not df_schedule.empty:
            csv_sched = convert_df_to_csv(df_schedule)
            st.download_button("‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥ (CSV)", csv_sched, f"schedule_{group_filter}.csv", "text/csv")
            st.table(df_schedule)
        else:
            st.info("–†–æ–∑–∫–ª–∞–¥ –¥–ª—è —Ü—ñ—î—ó –≥—Ä—É–ø–∏ —â–µ –Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–æ.")

    with tab2:
        if st.session_state['role'] in ['admin', 'teacher']:
            st.subheader("–î–æ–¥–∞—Ç–∏ –ø–∞—Ä—É")
            with st.form("add_schedule"):
                s_group = st.selectbox("–ì—Ä—É–ø–∞", list(GROUPS_DATA.keys()))
                s_day = st.selectbox("–î–µ–Ω—å", days)
                s_time = st.selectbox("–ß–∞—Å", ["08:30", "10:10", "11:50", "13:30", "15:00"])
                s_subject = st.text_input("–ü—Ä–µ–¥–º–µ—Ç")
                s_teacher = st.text_input("–í–∏–∫–ª–∞–¥–∞—á", value=st.session_state['full_name'])
                
                if st.form_submit_button("–ó–±–µ—Ä–µ–≥—Ç–∏"):
                    c = conn.cursor()
                    c.execute("INSERT INTO schedule (group_name, day, time, subject, teacher) VALUES (?,?,?,?,?)", 
                             (s_group, s_day, s_time, s_subject, s_teacher))
                    conn.commit()
                    st.success("–î–æ–¥–∞–Ω–æ!")
        else:
            st.error("–£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É.")

def documents_view():
    st.title("üìÇ –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±—ñ–≥ (–ó–∞—è–≤–∏)")
    menu = ["–ú–æ—ó –∑–∞—è–≤–∏", "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞—è–≤—É"]
    choice = st.selectbox("–û–ø—Ü—ñ—ó", menu)
    
    conn = create_connection()
    c = conn.cursor()
    
    if choice == "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞—è–≤—É":
        st.subheader("–ü–æ–¥–∞–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –∑–∞—è–≤–∏")
        doc_type = st.selectbox("–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞", ["–ó–∞—è–≤–∞ –Ω–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω—É –¥–æ–ø–æ–º–æ–≥—É", "–ó–∞—è–≤–∞ –Ω–∞ –ø–µ—Ä–µ–∑–¥–∞—á—É", "–î–æ–≤—ñ–¥–∫–∞ –ø—Ä–æ –Ω–∞–≤—á–∞–Ω–Ω—è"])
        reason = st.text_area("–û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è / –î–µ—Ç–∞–ª—ñ")
        
        if st.button("–ü—ñ–¥–ø–∏—Å–∞—Ç–∏ –ö–ï–ü —Ç–∞ –ù–∞–¥—ñ—Å–ª–∞—Ç–∏"):
            date_now = datetime.now().strftime("%Y-%m-%d %H:%M")
            c.execute("INSERT INTO documents (title, student_name, status, date) VALUES (?,?,?,?)", 
                     (doc_type, st.session_state['full_name'], "–ù–∞ —Ä–æ–∑–≥–ª—è–¥—ñ", date_now))
            conn.commit()
            st.success("–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –¥–µ–∫–∞–Ω–∞—Ç!")
            
    elif choice == "–ú–æ—ó –∑–∞—è–≤–∏":
        st.subheader("–Ü—Å—Ç–æ—Ä—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤")
        user = st.session_state['full_name']
        query = f"SELECT title as '–¢–∏–ø', status as '–°—Ç–∞—Ç—É—Å', date as '–î–∞—Ç–∞' FROM documents"
        
        if st.session_state['role'] == 'student':
            query += f" WHERE student_name='{user}'"
        else:
            query = "SELECT title as '–¢–∏–ø', student_name as '–°—Ç—É–¥–µ–Ω—Ç', status as '–°—Ç–∞—Ç—É—Å', date as '–î–∞—Ç–∞' FROM documents"
            
        df_docs = pd.read_sql_query(query, conn)
        st.dataframe(df_docs, use_container_width=True)

def file_repository_view():
    st.title("üóÑÔ∏è –§–∞–π–ª–æ–≤–∏–π –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π")
    st.markdown("–¢—É—Ç –º–æ–∂–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ **–±—É–¥—å-—è–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É** (PDF, Word, Excel, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–æ—â–æ).")
    
    conn = create_connection()
    c = conn.cursor()

    if st.session_state['role'] in ['admin', 'teacher']:
        with st.expander("üì§ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤–∏–π —Ñ–∞–π–ª", expanded=False):
            uploaded_file = st.file_uploader("–û–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª", accept_multiple_files=False)
            if uploaded_file is not None:
                if st.button("–ó–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª"):
                    try:
                        file_bytes = uploaded_file.read()
                        upload_date = datetime.now().strftime("%Y-%m-%d %H:%M")
                        
                        c.execute("INSERT INTO file_storage (filename, file_content, upload_date, uploader) VALUES (?,?,?,?)",
                                  (uploaded_file.name, file_bytes, upload_date, st.session_state['full_name']))
                        conn.commit()
                        st.success(f"–§–∞–π–ª '{uploaded_file.name}' —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!")
                        st.rerun()
                    except Exception as e:
                        st.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")

    st.divider()
    st.subheader("üìÅ –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª—ñ–≤")

    df_files = pd.read_sql_query("SELECT id, filename, upload_date, uploader FROM file_storage", conn)
    
    if not df_files.empty:
        for index, row in df_files.iterrows():
            col1, col2, col3, col4 = st.columns([3, 2, 2, 2])
            with col1:
                st.write(f"üìÑ **{row['filename']}**")
            with col2:
                st.caption(f"–î–∞—Ç–∞: {row['upload_date']}")
            with col3:
                file_data = c.execute("SELECT file_content FROM file_storage WHERE id=?", (row['id'],)).fetchone()[0]
                st.download_button(
                    label="‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏",
                    data=file_data,
                    file_name=row['filename'],
                    mime="application/octet-stream",
                    key=f"dl_{row['id']}"
                )
            with col4:
                if st.session_state['role'] == 'admin':
                    if st.button("üóëÔ∏è", key=f"del_{row['id']}", help="–í–∏–¥–∞–ª–∏—Ç–∏ —Ñ–∞–π–ª"):
                        c.execute("DELETE FROM file_storage WHERE id=?", (row['id'],))
                        conn.commit()
                        st.rerun()
    else:
        st.info("–†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –ø–æ—Ä–æ–∂–Ω—ñ–π.")

# --- –ù–û–í–ê –§–£–ù–ö–¶–Ü–Ø: –ï–õ–ï–ö–¢–†–û–ù–ù–ò–ô –ñ–£–†–ù–ê–õ (MATRIX VIEW) ---
def gradebook_view():
    st.title("üíØ –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –∂—É—Ä–Ω–∞–ª")
    conn = create_connection()
    
    # 1. –°–¢–£–î–ï–ù–¢–°–¨–ö–ò–ô –í–ò–ì–õ–Ø–î (–¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–¥ —Å–≤–æ—ó—Ö –æ—Ü—ñ–Ω–æ–∫)
    if st.session_state['role'] == 'student':
        user = st.session_state['full_name']
        st.info(f"–í—ñ—Ç–∞—î–º–æ, {user}. –û—Å—å –≤–∞—à—ñ —É—Å–ø—ñ—Ö–∏.")
        
        # –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –æ—Ü—ñ–Ω–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
        query = f"SELECT subject as '–ü—Ä–µ–¥–º–µ—Ç', type_of_work as '–í–∏–¥ —Ä–æ–±–æ—Ç–∏', grade as '–û—Ü—ñ–Ω–∫–∞', date as '–î–∞—Ç–∞' FROM grades WHERE student_name='{user}'"
        df_grades = pd.read_sql_query(query, conn)
        
        if not df_grades.empty:
            st.dataframe(df_grades, use_container_width=True)
            avg_grade = df_grades['–û—Ü—ñ–Ω–∫–∞'].mean()
            st.metric("–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª", f"{avg_grade:.1f}")
        else:
            st.warning("–û—Ü—ñ–Ω–æ–∫ –ø–æ–∫–∏ –Ω–µ–º–∞—î.")
            
    # 2. –í–ò–ö–õ–ê–î–ê–¶–¨–ö–ò–ô/–ê–î–ú–Ü–ù–°–¨–ö–ò–ô –í–ò–ì–õ–Ø–î (–ú–∞—Ç—Ä–∏—Ü—è —Ç–∞ –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è)
    else:
        st.subheader("–ü–∞–Ω–µ–ª—å –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è")
        
        # –ö—Ä–æ–∫ 1: –í–∏–±—ñ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
        col1, col2 = st.columns(2)
        with col1:
            all_groups = list(GROUPS_DATA.keys())
            selected_group = st.selectbox("–û–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É", all_groups)
        with col2:
            # –°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ (–º–æ–∂–Ω–∞ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏)
            subjects = ["–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑", "–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è", "–§—ñ–∑–∏–∫–∞", "–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞", "–î–∏—Å–∫—Ä–µ—Ç–Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞"]
            selected_subject = st.selectbox("–ü—Ä–µ–¥–º–µ—Ç", subjects)

        # –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –∫–æ–ª–æ–Ω–∫–∏ (—Ä–æ–±–æ—Ç–∏)
        with st.expander("‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ä–æ–±–æ—Ç—É (–∫–æ–ª–æ–Ω–∫—É) –≤ –∂—É—Ä–Ω–∞–ª"):
            with st.form("new_work_form"):
                new_work_name = st.text_input("–ù–∞–∑–≤–∞ —Ä–æ–±–æ—Ç–∏ (–Ω–∞–ø—Ä. '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ 1' –∞–±–æ '25.05')")
                date_val = st.date_input("–î–∞—Ç–∞")
                if st.form_submit_button("–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–æ–Ω–∫—É"):
                    if new_work_name:
                        # –ú–∏ –Ω–µ —Å—Ç–≤–æ—Ä—é—î–º–æ —Ñ—ñ–∑–∏—á–Ω—É –∫–æ–ª–æ–Ω–∫—É –≤ SQL, –º–∏ –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—î–º–æ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—é grades
                        # –ê–ª–µ —â–æ–± –≤–æ–Ω–∞ –∑'—è–≤–∏–ª–∞—Å—è –≤ –º–∞—Ç—Ä–∏—Ü—ñ, —Ç—Ä–µ–±–∞ —â–æ–± —Ö–æ—á–∞ –± —É –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –±—É–≤ –∑–∞–ø–∏—Å (–Ω–∞–≤—ñ—Ç—å –ø—É—Å—Ç–∏–π/0)
                        # –ê–±–æ –∫—Ä–∞—â–µ: –ø—Ä–æ—Å—Ç–æ –æ–Ω–æ–≤–∏–º–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É, —ñ –º–∞—Ç—Ä–∏—Ü—è –∑–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è, —è–∫—â–æ –º–∏ –¥–æ–¥–∞–º–æ –¥–µ—Ñ–æ–ª—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
                        # –°—Ç—Ä–∞—Ç–µ–≥—ñ—è: –î–æ–¥–∞—î–º–æ –≤—Å—ñ–º —Å—Ç—É–¥–µ–Ω—Ç–∞–º –≥—Ä—É–ø–∏ —Ü—é —Ä–æ–±–æ—Ç—É –∑ –æ—Ü—ñ–Ω–∫–æ—é 0 (–∞–±–æ NULL)
                        c = conn.cursor()
                        students_list = pd.read_sql_query(f"SELECT full_name FROM students WHERE group_name='{selected_group}'", conn)['full_name'].tolist()
                        
                        for stud in students_list:
                            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≤–∂–µ —î —Ç–∞–∫–∏–π –∑–∞–ø–∏—Å, —â–æ–± –Ω–µ –¥—É–±–ª—é–≤–∞—Ç–∏
                            check = c.execute("SELECT id FROM grades WHERE student_name=? AND subject=? AND type_of_work=?", (stud, selected_subject, new_work_name)).fetchone()
                            if not check:
                                c.execute("INSERT INTO grades (student_name, group_name, subject, type_of_work, grade, date) VALUES (?,?,?,?,?,?)",
                                          (stud, selected_group, selected_subject, new_work_name, 0, str(date_val)))
                        conn.commit()
                        st.success(f"–†–æ–±–æ—Ç—É '{new_work_name}' –¥–æ–¥–∞–Ω–æ –¥–ª—è –≥—Ä—É–ø–∏ {selected_group}!")
                        st.rerun()
                    else:
                        st.warning("–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ä–æ–±–æ—Ç–∏")

        # –ö—Ä–æ–∫ 3: –§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ú–ê–¢–†–ò–¶–Ü
        # –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ –¥–ª—è Pivot Table
        raw_data = pd.read_sql_query(f"SELECT student_name, type_of_work, grade FROM grades WHERE group_name='{selected_group}' AND subject='{selected_subject}'", conn)
        
        # –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, —â–æ–± –≤–æ–Ω–∏ –±—É–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü—ñ –Ω–∞–≤—ñ—Ç—å –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫
        students_df = pd.read_sql_query(f"SELECT full_name FROM students WHERE group_name='{selected_group}'", conn)
        
        if not students_df.empty:
            if not raw_data.empty:
                # –°—Ç–≤–æ—Ä—é—î–º–æ –º–∞—Ç—Ä–∏—Ü—é: –Ü–Ω–¥–µ–∫—Å=–°—Ç—É–¥–µ–Ω—Ç, –ö–æ–ª–æ–Ω–∫–∏=–†–æ–±–æ—Ç–∏, –ó–Ω–∞—á–µ–Ω–Ω—è=–û—Ü—ñ–Ω–∫–∞
                matrix_df = raw_data.pivot_table(index='student_name', columns='type_of_work', values='grade', aggfunc='first').fillna(0)
                
                # –û–±'—î–¥–Ω—É—î–º–æ –∑ –ø–æ–≤–Ω–∏–º —Å–ø–∏—Å–∫–æ–º —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ (Left Join), —â–æ–± –Ω–µ –∑–∞–≥—É–±–∏—Ç–∏ —Ç–∏—Ö, —É –∫–æ–≥–æ –Ω–µ–º–∞—î –æ—Ü—ñ–Ω–æ–∫
                full_matrix = pd.DataFrame(students_df['full_name']).merge(matrix_df, left_on='full_name', right_index=True, how='left').fillna(0)
                full_matrix.set_index('full_name', inplace=True)
                
                st.write("–†–µ–¥–∞–≥—É–π—Ç–µ –æ—Ü—ñ–Ω–∫–∏ –ø—Ä—è–º–æ —Ç—É—Ç (–Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Enter –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏):")
                edited_df = st.data_editor(full_matrix, use_container_width=True)
                
                # –ö—Ä–æ–∫ 4: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω
                if st.button("üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏ –≤ –∂—É—Ä–Ω–∞–ª—ñ"):
                    c = conn.cursor()
                    # –ü—Ä–æ—Ö–æ–¥–∏–º–æ –ø–æ —Ä–µ–¥–∞–≥–æ–≤–∞–Ω—ñ–π –º–∞—Ç—Ä–∏—Ü—ñ —ñ –æ–Ω–æ–≤–ª—é—î–º–æ –ë–î
                    # edited_df: index=student_name, columns=works
                    for student_name, row in edited_df.iterrows():
                        for work_name, new_grade in row.items():
                            # Upsert –ª–æ–≥—ñ–∫–∞ (–û–Ω–æ–≤–∏—Ç–∏ –∞–±–æ –í—Å—Ç–∞–≤–∏—Ç–∏)
                            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è
                            exists = c.execute("SELECT id FROM grades WHERE student_name=? AND subject=? AND type_of_work=?", 
                                             (student_name, selected_subject, work_name)).fetchone()
                            
                            if exists:
                                c.execute("UPDATE grades SET grade=? WHERE id=?", (new_grade, exists[0]))
                            else:
                                today = datetime.now().strftime("%Y-%m-%d")
                                c.execute("INSERT INTO grades (student_name, group_name, subject, type_of_work, grade, date) VALUES (?,?,?,?,?,?)",
                                          (student_name, selected_group, selected_subject, work_name, new_grade, today))
                    
                    conn.commit()
                    st.success("–ñ—É—Ä–Ω–∞–ª —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ!")
                    
            else:
                st.info("–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö —Ä–æ–±—ñ—Ç –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç—É. –î–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à—É —Ä–æ–±–æ—Ç—É –≤–∏—â–µ.")
        else:
            st.warning("–£ —Ü—ñ–π –≥—Ä—É–ø—ñ –Ω–µ–º–∞—î —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤.")

# --- –ì–û–õ–û–í–ù–ò–ô –ó–ê–ü–£–°–ö ---

def main():
    init_db()
    
    if 'logged_in' not in st.session_state:
        st.session_state['logged_in'] = False
        st.session_state['role'] = None
        st.session_state['full_name'] = ""

    if not st.session_state['logged_in']:
        login_register_page()
    else:
        # SIDEBAR NAVIGATION
        st.sidebar.title(f"üë§ {st.session_state['full_name']}")
        st.sidebar.caption(f"–†–æ–ª—å: {st.session_state['role']}")
        if st.session_state['role'] == 'student':
             st.sidebar.caption(f"–ì—Ä—É–ø–∞: {st.session_state['group']}")
        
        st.sidebar.divider()
        
        menu_options = {
            "–ì–æ–ª–æ–≤–Ω–∞ –ø–∞–Ω–µ–ª—å": main_panel,
            "–°—Ç—É–¥–µ–Ω—Ç–∏ —Ç–∞ –ì—Ä—É–ø–∏": students_groups_view,
            "–í–∏–∫–ª–∞–¥–∞—á—ñ —Ç–∞ –ö–∞—Ñ–µ–¥—Ä–∏": teachers_view,
            "–†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å": schedule_view,
            "–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –∂—É—Ä–Ω–∞–ª": gradebook_view, # <-- –ù–æ–≤–∏–π –ø—É–Ω–∫—Ç
            "–î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±—ñ–≥": documents_view,
            "–§–∞–π–ª–æ–≤–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π": file_repository_view
        }
        
        selection = st.sidebar.radio("–ù–∞–≤—ñ–≥–∞—Ü—ñ—è", list(menu_options.keys()))
        
        # –í–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        menu_options[selection]()
        
        st.sidebar.divider()
        if st.sidebar.button("–í–∏–π—Ç–∏"):
            st.session_state['logged_in'] = False
            st.rerun()

if __name__ == '__main__':
    main()
